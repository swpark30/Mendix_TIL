## Data Conversions(변환) 처리



### 도메인 모델 변경 유형

- 도메인 모델에서 속성, 엔티티 또는 연결을 삭제/변경하는 순간 전과 후의 데이터베이스가 그에 따라 동기화 된다.
- 데이터베이스의 기존 데이터에 영향을 미치는 2가지 유형의 변경 사항
  - Attribute Type Changes
    - 유형 변경에는 속성 및 연결 유형의 변경이 포함된다.
    - 모든 변경이 가능한 것은 아니므로 문자열을 정수로 변환같은 경우는 불가능하다.
    - 대부분의 변환은 자동으로 처리할 수 없기 때문에 많은 제어가 필요하다.
    - 새 속성을 추가하고 마이크로플로우를 통해 데이터를 변환하는 것이 좋다
  - Structural Changes
    - 구조적 변경은 기존 구조를 대체하기 위해 새로운 엔티티, 속성 및 연결이 도입되는 변경이다.
    - 이러한 변경은 이전 상황을 새로운 상황으로 변경하기 위한 입력이 필요하고 항상 마이크로플로우를 통해 수행된다.



### 도메인 모델의 재구성

- 변경을 가장 잘 수행하는 방법의 프로세스
- 몇가지 가정
  - 이전 상황은 전환되는 동안 새로운 상황에 따라 존재해야한다.
  - 변경은 배포 후에 발생하고 새 상황을 데이터베이스에 동기화해야 한다.
  - 이전 상황은 변경 후 더 이상 존재하지 않아야 한다.
- 목표 달성을 위한 단계별 로켓
  1. 도메인 모델 확장
     - 새로운 엔티티, 속성, 연결로 도메인 모델을 확장한다.
     - 이전 상황을 사용할 수 있도록 유지한다.
  2. 데이터 변환 모델링
     - 이전 데이터를 새 상황으로 변환해야 하는 방법을 인지하고 그에 따라 변환 마이크로플로우를 모델링하고 배포 후 관리자가 이 마이크로플로우를 실행할 수 있도록 논리적 위치의 버튼에 연결하는 것이다.
  3. 새 모델 배포 및 데이터 변환
     - 프로덕션에 앱을 배포하는 것
     - 배포 후 관리자 계정으로 로그인하여 변환 마이크로플로우를 실행하고 모든 데이터가 제대로 변환되었는지 확인한다.
     - 이전 상황과 새로운 상황을 비교하여 데이터를 확인한다.
  4. 모델 정리
     - 도메인 모델과 관련된 페이지,마이크로플로우를 정리하고 변환 후 최종 버전을 배포한다.



### Player 데이터를 Person 항목에 병합

- 바꾸고 싶은 엔티티의 속성으로 데이터를 이전시키는 역할을 한다
- Old Entity를 Retrieve해서 New Entity에 넣어주는 마이크로플로우를 만들어서 앱을 실행시킨 후 마이크로플로우를 트리거하는 버튼을 눌러줘서 데이터를 옮겨준다.
- 다 옮겨졌으면 Old Entity나 속성을 삭제해준다.